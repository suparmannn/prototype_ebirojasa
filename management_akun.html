<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Management Akun</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- Root Variables & Global Reset --- */
        :root {
            --primary-blue: #0A7EFF; --primary-blue-dark: #0056b3; --sidebar-bg: #1C2E46; --bg-light: #F8F9FA; --card-bg: #FFFFFF; --text-dark: #343A40; --text-medium: #6C757D; --text-light: #CED4DA; --border-color: #E9ECEF; --shadow-light: 0 4px 15px rgba(0, 0, 0, 0.08); --shadow-input: 0 0 0 3px rgba(10, 126, 255, 0.1);
            --status-green: #15803D; --status-green-bg: #F0FDF4;
            --status-red: #D92D20; --status-red-bg: #FFF0F0;
        }
        body, html { margin: 0; padding: 0; font-family: 'Poppins', sans-serif; background-color: var(--bg-light); height: 100%; overflow: hidden; color: var(--text-dark); }
        * { box-sizing: border-box; }
        .admin-layout { display: flex; height: 100vh; }

        /* --- Sidebar --- */
        .sidebar { width: 280px; background-color: var(--sidebar-bg); padding: 30px 0; display: flex; flex-direction: column; flex-shrink: 0; position: relative; z-index: 100; box-shadow: 2px 0 10px rgba(0,0,0,0.1); }
        .sidebar-logo { display: flex; align-items: center; justify-content: center; padding: 0 20px 30px; margin-bottom: 30px; border-bottom: 1px solid rgba(255, 255, 255, 0.08); }
        .sidebar-logo svg { height: 35px; margin-right: 12px; color: var(--primary-blue); filter: drop-shadow(0 0 5px rgba(10, 126, 255, 0.5)); }
        .sidebar-logo span { font-size: 1.6rem; font-weight: 700; color: #ffffff; letter-spacing: 0.5px; }
        .sidebar-nav { list-style: none; padding: 0; margin: 0; }
        .sidebar-nav li { margin-bottom: 8px; }
        .sidebar-nav a { display: flex; align-items: center; padding: 14px 30px; text-decoration: none; color: var(--text-light); font-weight: 500; font-size: 0.98rem; transition: all 0.3s ease; position: relative; }
        .sidebar-nav a i { margin-right: 18px; font-size: 1.1rem; width: 20px; text-align: center; }
        .sidebar-nav li.active a { background: linear-gradient(90deg, var(--primary-blue), rgba(10, 126, 255, 0.8)); color: #ffffff; border-radius: 0 50px 50px 0; box-shadow: 0 5px 15px rgba(10, 126, 255, 0.3); left: 0; }
        .sidebar-nav li:not(.active) a:hover { background-color: rgba(255, 255, 255, 0.08); color: #ffffff; border-radius: 0 50px 50px 0; }
        
        /* --- Content --- */
        .main-content { flex-grow: 1; display: flex; flex-direction: column; padding: 30px; overflow-y: auto; }
        
        /* --- Topbar (Telah Diupdate) --- */
        .topbar {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 15px 30px;
            display: flex;
            align-items: center;
            justify-content: flex-end; /* BERUBAH: Mendorong ke kanan */
            margin-bottom: 30px;
            box-shadow: var(--shadow-light);
            animation: fadeInDown 0.5s ease-out;
        }
        .topbar-right { display: flex; align-items: center; gap: 25px; }
        .topbar-icon { color: var(--text-medium); font-size: 1.3rem; position: relative; cursor: pointer; transition: color 0.2s; }
        .topbar-icon:hover { color: var(--primary-blue); }
        .topbar-icon .badge { position: absolute; top: -8px; right: -10px; background-color: #F44336; color: white; font-size: 0.75rem; padding: 4px 7px; border-radius: 50%; line-height: 1; font-weight: 600; }
        .user-menu { display: flex; align-items: center; cursor: pointer; padding: 5px 10px; border-radius: 10px; transition: background-color 0.2s; }
        .user-menu:hover { background-color: var(--bg-light); }
        .user-menu img { width: 40px; height: 40px; border-radius: 50%; margin-right: 12px; border: 2px solid var(--border-color); object-fit: cover; }
        .user-menu span { font-weight: 600; color: var(--text-dark); margin-right: 10px; }
        .user-menu i { color: var(--text-medium); font-size: 0.9rem; }

        /* --- Content Area --- */
        .content-area { flex-grow: 1; background-color: var(--card-bg); border-radius: 15px; padding: 30px; box-shadow: var(--shadow-light); display: flex; flex-direction: column; overflow: hidden; animation: fadeInUp 0.5s ease-out 0.2s forwards; opacity: 0; }
        .content-header-main { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .content-header-left { display: flex; align-items: center; }
        .back-button { background: none; border: none; font-size: 1.6rem; color: var(--text-medium); cursor: pointer; margin-right: 18px; transition: color 0.2s, transform 0.2s; }
        .back-button:hover { color: var(--primary-blue); transform: translateX(-3px); }
        .content-header-left h1 { font-size: 2rem; color: var(--text-dark); margin: 0; font-weight: 700; letter-spacing: -0.5px; }
        .btn-add-new { background: linear-gradient(45deg, var(--primary-blue), #5e9eff); color: white; padding: 12px 25px; border-radius: 10px; text-decoration: none; font-weight: 600; font-size: 0.95rem; display: flex; align-items: center; transition: all 0.3s ease; box-shadow: 0 5px 15px rgba(10, 126, 255, 0.3); white-space: nowrap; cursor: pointer; }
        .btn-add-new i { margin-right: 10px; font-size: 1.1rem; }
        .btn-add-new:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(10, 126, 255, 0.4); }
        
        /* --- Table --- */
        .table-controls { display: flex; justify-content: flex-end; margin-bottom: 20px; }
        .table-search { position: relative; width: 300px; }
        .table-search input { width: 100%; padding: 10px 15px 10px 40px; border: 1px solid var(--border-color); border-radius: 10px; font-size: 0.95rem; background-color: #ffffff; transition: all 0.3s ease; }
        .table-search input:focus { outline: none; border-color: var(--primary-blue); box-shadow: var(--shadow-input); background-color: #ffffff; }
        .table-search i { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--text-medium); font-size: 1rem; }
        .data-table-wrapper { flex-grow: 1; overflow-y: auto; margin-bottom: 25px; }
        .data-table { width: 100%; border-collapse: separate; border-spacing: 0; font-size: 0.95rem; min-width: 700px; }
        .data-table th, .data-table td { padding: 18px 20px; text-align: left; border-bottom: 1px solid var(--border-color); white-space: nowrap; }
        .data-table th { background-color: var(--bg-light); font-weight: 600; color: var(--text-dark); position: sticky; top: 0; z-index: 1; }
        .data-table thead th:first-child { border-top-left-radius: 10px; }
        .data-table thead th:last-child { border-top-right-radius: 10px; }
        .data-table tbody tr:last-child td { border-bottom: none; }
        .data-table tbody tr:hover { background-color: #EBF5FF; }
        .data-table td:last-child { width: 150px; text-align: center; }
        .data-table .action-icons { display: flex; justify-content: center; gap: 15px; }
        .data-table .action-icons a { color: var(--text-medium); font-size: 1.15rem; transition: color 0.2s, transform 0.2s; cursor: pointer; }
        .data-table .action-icons a:hover { color: var(--primary-blue); transform: scale(1.1); }
        .data-table .action-icons .action-delete:hover { color: #dc3545; }
        
        /* --- Badge Status Akun --- */
        .status-badge { padding: 5px 12px; border-radius: 20px; font-weight: 600; font-size: 0.85rem; }
        .status-superadmin { background-color: var(--status-red-bg); color: var(--status-red); }
        .status-admin { background-color: #EBF5FF; color: var(--primary-blue); }
        .status-admindev { background-color: var(--status-green-bg); color: var(--status-green); }

        /* --- Pagination --- */
        .pagination { display: flex; justify-content: center; align-items: center; margin-top: auto; padding-top: 20px; border-top: 1px solid var(--border-color); }
        .pagination a { text-decoration: none; color: var(--text-medium); padding: 10px 18px; border: 1px solid var(--border-color); border-radius: 8px; margin: 0 5px; transition: all 0.3s ease; font-weight: 500; }
        .pagination a.current-page { background: var(--primary-blue); color: white; border-color: var(--primary-blue); box-shadow: 0 3px 10px rgba(10, 126, 255, 0.2); }
        .pagination a:hover:not(.current-page) { background-color: #EBF5FF; color: var(--primary-blue); border-color: #A0D3FF; }
        .pagination a.disabled { color: var(--text-light); cursor: not-allowed; background-color: #F0F2F5; border-color: #E0E0E0; box-shadow: none; }
        
        /* --- Animations --- */
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        /* --- Modal --- */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1000; display: flex; justify-content: center; align-items: center; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease; }
        .modal-overlay.show { opacity: 1; visibility: visible; }
        .modal-content { background-color: var(--card-bg); padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15); width: 90%; max-width: 500px; transform: scale(0.95); transition: transform 0.3s ease; }
        .modal-overlay.show .modal-content { transform: scale(1); }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid var(--border-color); }
        .modal-header h2 { margin: 0; font-size: 1.5rem; color: var(--text-dark); font-weight: 600; }
        .modal-close-btn { background: none; border: none; font-size: 1.8rem; color: var(--text-medium); cursor: pointer; transition: color 0.2s; }
        .modal-close-btn:hover { color: var(--text-dark); }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 8px; color: var(--text-medium); }
        .form-group input, .form-group select { width: 100%; padding: 12px 18px; border: 1px solid var(--border-color); border-radius: 10px; font-size: 1rem; background-color: #ffffff; transition: all 0.3s ease; color: var(--text-dark); font-family: 'Poppins', sans-serif; }
        .form-group input:focus, .form-group select:focus { outline: none; border-color: var(--primary-blue); box-shadow: var(--shadow-input); background-color: #ffffff; }
        .form-group .password-helper-text { font-size: 0.85rem; color: var(--text-medium); margin-top: 5px; }
        .modal-footer { display: flex; justify-content: flex-end; gap: 15px; margin-top: 30px; }
        .btn { padding: 12px 25px; border: none; border-radius: 10px; font-weight: 600; font-size: 0.95rem; cursor: pointer; transition: all 0.3s ease; }
        .btn-secondary { background-color: var(--bg-light); color: var(--text-medium); border: 1px solid var(--border-color); }
        .btn-secondary:hover { background-color: var(--border-color); }
        .btn-primary { background: linear-gradient(45deg, var(--primary-blue), #5e9eff); color: white; box-shadow: 0 5px 15px rgba(10, 126, 255, 0.3); }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(10, 126, 255, 0.4); }
    </style>
</head>
<body>

    <div class="admin-layout">
        
        <aside class="sidebar">
            <div class="sidebar-logo">
                <svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue">
                    <path d="M4 17V8a2 2 0 0 1 2-2h8.5L20 10.5V20a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2Z"/>
                    <path d="M10 2v4"/><path d="M10 18v4"/><path d="M10 6h4"/><path d="M10 18h4"/><path d="M6 10h4"/><path d="M6 14h4"/>
                </svg>
                <span>E-Biro Jasa</span>
            </div>
            
            <ul class="sidebar-nav">
                <li><a href="#"><i class="fas fa-fw fa-tachometer-alt"></i><span>Dashboard Utama</span></a></li>
                <li><a href="index.html"><i class="fas fa-fw fa-money-check-alt"></i><span>Data Portal PKB</span></a></li>
                <li class="active"><a href="management_akun.html"><i class="fas fa-fw fa-users"></i><span>Management Akun</span></a></li>
                <li><a href="management_produk.html"><i class="fas fa-fw fa-box"></i><span>Management Produk</span></a></li>
                <li><a href="pos.html"><i class="fas fa-fw fa-cash-register"></i><span>POS</span></a></li>
                <li><a href="laporan_transaksi.html"><i class="fas fa-fw fa-chart-line"></i><span>Laporan Transaksi</span></a></li>
            </ul>
        </aside>

        <main class="main-content">
            
            <div class="topbar">
                <div class="topbar-right">
                    <a href="#" class="topbar-icon"> <i class="fas fa-bell"></i> <span class="badge">3</span> </a>
                    <div class="user-menu"> <img src="https://via.placeholder.com/40" alt="User Avatar"> <span>Admin</span> <i class="fas fa-chevron-down"></i> </div>
                </div>
            </div>

            <div class="content-area">
                <div class="content-header-main">
                    <div class="content-header-left">
                        <button class="back-button"><i class="fas fa-chevron-left"></i></button>
                        <h1>Management Akun Pengguna</h1>
                    </div>
                    <a id="btn-add-main" class="btn-add-new">
                        <i class="fas fa-plus"></i> Tambah Akun Baru
                    </a>
                </div>

                <div class="table-controls">
                    <div class="table-search">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Cari berdasarkan Nama atau Username">
                    </div>
                </div>

                <div class="data-table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Nama</th>
                                <th>Username (Email)</th>
                                <th>Level</th>
                                <th>Pusat/Cabang</th>
                                <th>Tanggal Bergabung</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="data-table-body">
                            <tr> <td>Super Admin</td> <td>super@ebirojasa.com</td> <td><span class="status-badge status-superadmin">Superadmin</span></td> <td>Pusat</td> <td>2023-01-01</td> <td> <div class="action-icons"> <a title="Edit" class="action-edit"><i class="fas fa-edit"></i></a> <a title="Hapus" class="action-delete"><i class="fas fa-trash-alt"></i></a> </div> </td> </tr>
                            <tr> <td>Admin Adira</td> <td>admin.adira@gmail.com</td> <td><span class="status-badge status-admin">Admin</span></td> <td>Adira</td> <td>2023-05-10</td> <td> <div class="action-icons"> <a title="Edit" class="action-edit"><i class="fas fa-edit"></i></a> <a title="Hapus" class="action-delete"><i class="fas fa-trash-alt"></i></a> </div> </td> </tr>
                            <tr> <td>Admin CV Anugerah</td> <td>admin.anugerah@gmail.com</td> <td><span class="status-badge status-admin">Admin</span></td> <td>CV Anugerah</td> <td>2023-05-11</td> <td> <div class="action-icons"> <a title="Edit" class="action-edit"><i class="fas fa-edit"></i></a> <a title="Hapus" class="action-delete"><i class="fas fa-trash-alt"></i></a> </div> </td> </tr>
                            <tr> <td>Developer E-Biro</td> <td>dev@ebirojasa.com</td> <td><span class="status-badge status-admindev">Admin Dev</span></td> <td>Pusat</td> <td>2023-02-15</td> <td> <div class="action-icons"> <a title="Edit" class="action-edit"><i class="fas fa-edit"></i></a> <a title="Hapus" class="action-delete"><i class="fas fa-trash-alt"></i></a> </div> </td> </tr>
                        </tbody>
                    </table>
                </div>

                <div class="pagination">
                    <a href="#" class="disabled">Previous</a>
                    <a href="#" class="current-page">1</a>
                    <a href="#">Next</a>
                </div>
            </div>
        </main>
    </div>

    <div class="modal-overlay" id="crud-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Tambah Akun Baru</h2>
                <button class="modal-close-btn" id="modal-close-btn">&times;</button>
            </div>
            <form id="crud-form">
                <input type="hidden" id="form-mode" value="create">
                <div class="form-group">
                    <label for="akun-nama">Nama</label>
                    <input type="text" id="akun-nama" placeholder="e.g: Admin Adira" required>
                </div>
                <div class="form-group">
                    <label for="akun-username">Username (Email)</label>
                    <input type="email" id="akun-username" placeholder="e.g: admin.adira@gmail.com" required>
                </div>
                <div class="form-group">
                    <label for="akun-level">Level</label>
                    <select id="akun-level" required>
                        <option value="" disabled selected>Pilih level akun</option>
                        <option value="Superadmin">Superadmin</option>
                        <option value="Admin">Admin</option>
                        <option value="Admin Dev">Admin Dev</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="akun-cabang">Pusat/Cabang</label>
                    <input type="text" id="akun-cabang" placeholder="e.g: Adira / CV Anugerah / Pusat" required>
                </div>
                <div class="form-group">
                    <label for="akun-password">Password</label>
                    <input type="password" id="akun-password" placeholder="Masukkan password baru" required>
                    <small class="password-helper-text" id="password-helper"></small>
                </div>
                <div class="form-group">
                    <label for="akun-password-confirm">Konfirmasi Password</label>
                    <input type="password" id="akun-password-confirm" placeholder="Ulangi password baru" required>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="modal-cancel-btn">Batal</button>
                    <button type="submit" class="btn btn-primary">Simpan</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const modal = document.getElementById('crud-modal');
            const btnAddMain = document.getElementById('btn-add-main');
            const btnModalClose = document.getElementById('modal-close-btn');
            const btnModalCancel = document.getElementById('modal-cancel-btn');
            const crudForm = document.getElementById('crud-form');
            const modalTitle = document.getElementById('modal-title');
            const formMode = document.getElementById('form-mode');
            const tableBody = document.getElementById('data-table-body');
            const inputAkunNama = document.getElementById('akun-nama');
            const inputAkunUsername = document.getElementById('akun-username');
            const inputAkunLevel = document.getElementById('akun-level');
            const inputAkunCabang = document.getElementById('akun-cabang');
            const inputAkunPassword = document.getElementById('akun-password');
            const inputAkunPasswordConfirm = document.getElementById('akun-password-confirm');
            const passwordHelper = document.getElementById('password-helper');
            let currentRowBeingEdited = null;
            
            const getBadgeClass = (level) => {
                if (level === 'Superadmin') return 'status-superadmin';
                if (level === 'Admin') return 'status-admin';
                if (level === 'Admin Dev') return 'status-admindev';
                return 'status-admin';
            };

            const showModal = (mode, rowElement = null) => {
                formMode.value = mode;
                crudForm.reset();
                if (mode === 'create') {
                    modalTitle.textContent = 'Tambah Akun Baru';
                    currentRowBeingEdited = null;
                    inputAkunPassword.required = true;
                    inputAkunPasswordConfirm.required = true;
                    passwordHelper.textContent = '';
                } else if (mode === 'update') {
                    modalTitle.textContent = 'Edit Akun Pengguna';
                    currentRowBeingEdited = rowElement;
                    const nama = rowElement.cells[0].textContent;
                    const username = rowElement.cells[1].textContent;
                    const level = rowElement.cells[2].textContent;
                    const cabang = rowElement.cells[3].textContent;
                    inputAkunNama.value = nama;
                    inputAkunUsername.value = username;
                    inputAkunLevel.value = level;
                    inputAkunCabang.value = cabang;
                    inputAkunPassword.required = false;
                    inputAkunPasswordConfirm.required = false;
                    inputAkunPassword.placeholder = "********";
                    inputAkunPasswordConfirm.placeholder = "********";
                    passwordHelper.textContent = 'Kosongkan jika tidak ingin mengubah password.';
                }
                modal.classList.add('show');
            };
            
            const hideModal = () => { modal.classList.remove('show'); crudForm.reset(); currentRowBeingEdited = null; };
            const addRowToTable = (nama, username, level, cabang) => {
                const newRow = tableBody.insertRow();
                const badgeClass = getBadgeClass(level);
                newRow.innerHTML = `<td>${nama}</td> <td>${username}</td> <td><span class="status-badge ${badgeClass}">${level}</span></td> <td>${cabang}</td> <td>${new Date().toISOString().split('T')[0]}</td> <td> <div class="action-icons"> <a title="Edit" class="action-edit"><i class="fas fa-edit"></i></a> <a title="Hapus" class="action-delete"><i class="fas fa-trash-alt"></i></a> </div> </td>`;
                addEventListenersToRow(newRow);
            };
            const updateRowInTable = (rowElement, nama, username, level, cabang) => {
                const badgeClass = getBadgeClass(level);
                rowElement.cells[0].textContent = nama;
                rowElement.cells[1].textContent = username;
                rowElement.cells[2].innerHTML = `<span class="status-badge ${badgeClass}">${level}</span>`;
                rowElement.cells[3].textContent = cabang;
            };
            const deleteRow = (rowElement) => { if (confirm('Anda yakin ingin menghapus akun ini?')) { rowElement.remove(); } };
            const addEventListenersToRow = (rowElement) => {
                const editBtn = rowElement.querySelector('.action-edit');
                const deleteBtn = rowElement.querySelector('.action-delete');
                editBtn.addEventListener('click', () => { showModal('update', rowElement); });
                deleteBtn.addEventListener('click', () => { deleteRow(rowElement); });
            };
            
            btnAddMain.addEventListener('click', () => { showModal('create'); });
            btnModalClose.addEventListener('click', hideModal);
            btnModalCancel.addEventListener('click', hideModal);
            modal.addEventListener('click', (e) => { if (e.target === modal) { hideModal(); } });
            
            crudForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const nama = inputAkunNama.value;
                const username = inputAkunUsername.value;
                const level = inputAkunLevel.value;
                const cabang = inputAkunCabang.value;
                const password = inputAkunPassword.value;
                const passwordConfirm = inputAkunPasswordConfirm.value;
                
                if (password !== passwordConfirm) { alert('Password dan Konfirmasi Password tidak cocok!'); return; }
                if (formMode.value === 'create' && (!password || !passwordConfirm)) { alert('Password wajib diisi untuk akun baru!'); return; }
                if (formMode.value === 'update' && (password || passwordConfirm)) { if (password !== passwordConfirm) { alert('Password dan Konfirmasi Password tidak cocok!'); return; } console.log("Password akan diubah untuk: " + username); }
                if (formMode.value === 'create') { addRowToTable(nama, username, level, cabang); } else if (formMode.value === 'update') { updateRowInTable(currentRowBeingEdited, nama, username, level, cabang); }
                hideModal();
            });
            tableBody.querySelectorAll('tr').forEach(row => { addEventListenersToRow(row); });
        });
    </script>
</body>

</html>
